
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PHP - Reusing Code With Traits - Dio's Blog</title>
  <meta name="author" content="Diogo Pinto">

  
  <meta name="description" content="Propósito geral dos Traits A Orientação a Objetos em PHP, não trabalha com conceitos de herança múltipla. Apesar da herança múltipla não fazer
falta &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://di0.github.io/blog/2012/12/01/php-reusing-code-with-traits">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Dio's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><div class="header-left">
  <hgroup>
  <h1><a href="/">Dio's Blog</a></h1>
  
  <div class="subtitle">
    <h2>By Diogo Pinto</h2>
  </div>
  
  </hgroup>
  
</div>

<div class="header-right">
  <ul class="main-navigation">
 <div> 
  <li><a href="/">blog</a></li></div><div class="spacer"></div>
     <div> 
  <li><a href="/projects">projects</a></li></div><div class="spacer"></div>
       <div> 
  <li><a href="/work">work</a></li></div><div class="spacer"></div>
         <div> 
  <li><a href="/about">about</a></li></div>
</ul>
  

</div>
</header>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">PHP - Reusing Code With Traits</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-01T22:21:08-02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Propósito geral dos Traits</p>

<p>A Orientação a Objetos em PHP, não trabalha com conceitos de herança múltipla. Apesar da herança múltipla não fazer
falta alguma em PHP(ou em qualquer outra linguagem), por trazer consigo mais desvantagens do que vantagens, como
implementações difíceis, manutenção trabalhosa, acoplamento forte, baixa coesão e centenas de outros
problemas, há ainda assim, a necessidade de se reutilizar recursos em diferentes locais, evitando rescrever trechos
repetidos de códigos.</p>

<p>Traits são mecanismos que possibilitam o reuso de código, em um contexto relacional não vertical. Com traits, em uma
única classe é possível utilizar recursos que se tornam modulares e que são carregados conforme necessidade. A vantagem de
utilizar <strong>Traits</strong>, vai além da reutilização e, o grande destaque está em seu relacionamento com outros participantes que, ao
contrário da herança, não tem o relacionamento <em>&ldquo;É UM&rdquo;</em> e sim um talvez, se <em>&ldquo;COMPORTA(-SE) COMO&rdquo;</em>. Essa sútil diferença é de suma
importância, evitando os problemas citados anteriormente quando se faz o uso indiscriminado e / ou incorreto de uma ou muitas
extensões(o qual já foi citado não ser suportado no PHP), evitando-se relacionamentos excêntricos, <em>&ldquo;É UM&rdquo;</em>, onde por exemplo
uma classe Pessoa estende Database, formando o relacionamento Pessoa É UM Database, quando Pessoa, obviamente, não É UM Database.</p>

<p>Um exemplo simples para introduzir a sintaxe em torno das Traits:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">trait</span> <span class="nx">Foo</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">function</span> <span class="nf">firstName</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="s1">&#39;James&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">trait</span> <span class="nx">Bar</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">function</span> <span class="nf">lastName</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="s1">&#39;Bond&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Baz</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">use</span> <span class="nx">Foo</span><span class="p">,</span> <span class="nx">Bar</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$objBaz</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Baz</span><span class="p">();</span>
</span><span class='line'><span class="nv">$strResult</span>  <span class="o">=</span> <span class="s1">&#39;My name is &#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="nv">$objBaz</span><span class="o">-&gt;</span><span class="na">lastName</span><span class="p">();</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="s2">&quot;, &quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="nv">$objBaz</span><span class="o">-&gt;</span><span class="na">firstName</span><span class="p">();</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="s2">&quot; &quot;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="nv">$objBaz</span><span class="o">-&gt;</span><span class="na">lastName</span><span class="p">();</span>
</span><span class='line'><span class="nv">$strResult</span> <span class="o">.=</span> <span class="s2">&quot;!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</span><span class='line'><span class="k">echo</span> <span class="nv">$strResult</span><span class="p">;</span>          <span class="c1">// My name is Bond, James Bond!</span>
</span></code></pre></td></tr></table></div></figure>


<p>Traits assemelham-se às classes, mais aproximadamente às <!--more--> classes abstratas, que não
podem ser instanciadas diretamente, todavia, seu principal objetivo é de reunir
grupo(s) de comportamentos(s) que serão reutilizadas em um ou diversos pontos.</p>

<p>Visão mais ampla</p>

<p>Um outro exemplo recorrente, ajuda a ilustrar melhor o propósito de Traits:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">trait</span> <span class="nx">Singleton</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">private</span> <span class="k">static</span> <span class="nv">$instance</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">getInstance</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="p">(</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$instance</span> <span class="nx">instanceof</span> <span class="nx">self</span> <span class="p">)</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>          <span class="nx">self</span><span class="o">::</span><span class="nv">$instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">self</span><span class="p">;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">return</span> <span class="nx">self</span><span class="o">::</span><span class="nv">$instance</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">protected</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">private</span> <span class="k">function</span> <span class="nf">__clone</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">private</span> <span class="k">function</span> <span class="nf">__wakeup</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">DatabaseLoader</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">use</span> <span class="nx">Singleton</span><span class="p">;</span>
</span><span class='line'>  <span class="p">{</span><span class="o">...</span><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span>  <span class="nc">FileLoader</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">use</span> <span class="nx">Singleton</span><span class="p">;</span>
</span><span class='line'>  <span class="p">{</span><span class="o">...</span><span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nesse exemplo, tanto a classe DatabaseLoader, como FileLoader, se comportam como Singleton, e por ambas herdarem
esse comportamento, não é possível(devido aos construtores protegidos) criar novos objetos dessas:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$database</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DatabaseLoader</span><span class="p">();</span>
</span><span class='line'><span class="nv">$file</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileLoader</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>PHP Fatal error: Call to protected DatabaseLoader::__construct<span class="o">()</span> from invalid context ...
</span><span class='line'>PHP Fatal error: Call to protected FileLoader::__construct<span class="o">()</span> from invalid context ...
</span></code></pre></td></tr></table></div></figure>


<p>As classes DatabaseLoader e FileLoader tem comportamentos idênticos à Trait Singleton, portanto, para o efeito
desejado o correto será:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nv">$databaseLoad_1</span> <span class="o">=</span> <span class="nx">DatabaseLoader</span><span class="o">::</span><span class="na">getInstance</span><span class="p">();</span>
</span><span class='line'><span class="nv">$databaseLoad_2</span> <span class="o">=</span> <span class="nx">DatabaseLoader</span><span class="o">::</span><span class="na">getInstance</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$fileLoad_1</span> <span class="o">=</span> <span class="nx">FileLoader</span><span class="o">::</span><span class="na">getInstance</span><span class="p">();</span>
</span><span class='line'><span class="nv">$fileLoad_2</span> <span class="o">=</span> <span class="nx">FileLoader</span><span class="o">::</span><span class="na">getInstance</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nv">$databaseLoad_1</span> <span class="nx">instanceof</span> <span class="nv">$databaseLoad_2</span> <span class="p">)</span>
</span><span class='line'>  <span class="k">echo</span> <span class="s2">&quot;Singleton is working&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span> <span class="nv">$fileLoad_1</span> <span class="nx">instanceof</span> <span class="nv">$fileLoad_2</span> <span class="p">)</span>
</span><span class='line'>  <span class="k">echo</span> <span class="s2">&quot;Singleton is working&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Isso reforça a grande cartada de Traits – possibilitar comportamentos aos participantes, ou seja, relacionamentos
do tipo comporta-se como. A leitura dessas classes seria algo adjacente a: DatabaseLoader e FileLoader não são
Singletons, não tem Singletons(usar singleton não é um contrato), mas se comportam como Singletons.</p>

<p>Futuramente, tanto DatabaseLoader como FileLoader, de maneira flexivelmente simples, poderiam deixar de se comportar
como Singletons, apenas deixando de usar(se comportar como) Trait Singleton.</p>

<p>Traits e Interface</p>

<p>Um exemplo usando Traits e Contrato:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">CSV</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">public</span> <span class="k">function</span> <span class="nf">Output</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                <span class="c1">// {...}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="s2">&quot;CSV file contents has been read&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">PDF</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">public</span> <span class="k">function</span> <span class="nf">Output</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                <span class="c1">// {...}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="s2">&quot;PDF file contents has been read&quot;</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">trait</span> <span class="nx">LoaderCSV</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="nv">$file</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">public</span> <span class="k">function</span> <span class="nf">read</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                <span class="nv">$csv</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CSV</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// {...}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="nv">$csv</span><span class="o">-&gt;</span><span class="na">Output</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">trait</span> <span class="nx">LoaderPDF</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">private</span> <span class="nv">$file</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">public</span> <span class="k">function</span> <span class="nf">read</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>                <span class="nv">$pdf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDF</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">file</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>                <span class="c1">// {...}</span>
</span><span class='line'>
</span><span class='line'>                <span class="k">return</span> <span class="nv">$pdf</span><span class="o">-&gt;</span><span class="na">Output</span><span class="p">();</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">interface</span> <span class="nx">ReaderFile</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">public</span> <span class="k">function</span> <span class="nf">read</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">PDFReaderFile</span> <span class="k">implements</span> <span class="nx">ReaderFile</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">use</span> <span class="nx">LoaderPDF</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">CSVReaderFile</span> <span class="k">implements</span> <span class="nx">ReaderFile</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>        <span class="k">use</span> <span class="nx">LoaderCSV</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">LoaderContents</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">private</span> <span class="nv">$contents</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="nx">ReaderFile</span> <span class="nv">$rf</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contents</span> <span class="o">=</span> <span class="nv">$rf</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// {...}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">public</span> <span class="k">function</span> <span class="nf">getContents</span><span class="p">()</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contents</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">//---------------------------------------------------------</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$filePDF</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoaderContents</span><span class="p">(</span><span class="k">new</span> <span class="nx">PDFReaderFile</span><span class="p">(</span><span class="s2">&quot;file.pdf&quot;</span><span class="p">));</span>
</span><span class='line'><span class="k">echo</span> <span class="nv">$filePDF</span><span class="o">-&gt;</span><span class="na">getContents</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>  <span class="c1">// PDF file contents has been read</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$fileCSV</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoaderContents</span><span class="p">(</span><span class="k">new</span> <span class="nx">CSVReaderFile</span><span class="p">(</span><span class="s2">&quot;file.csv&quot;</span><span class="p">));</span>
</span><span class='line'><span class="k">echo</span> <span class="nv">$fileCSV</span><span class="o">-&gt;</span><span class="na">getContents</span><span class="p">()</span> <span class="o">.</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>  <span class="c1">// CSV file contents has been read</span>
</span></code></pre></td></tr></table></div></figure>


<p>Há alguns pontos a serem ressaltados, por exemplo, como é notado, as classes PDFReaderFile e CSVReaderFile tem
(uma interface) um ReaderFile, mas cada um se comporta(uma trait) de uma maneira. Nesse caso também, foi
possível realizar uma abstração encapsulada, pois, quem usa a classe LoaderContents, não tem conhecimentos de que
o contrato assinado está sob comportamentos ou uma implementação.</p>

<p>Os construtores de cada Traits são herdados, tendo os construtores dos participantes que usam essas
Traits, os mesmos comportamentos.</p>

<p>Traits e Autload</p>

<p>Também é possível utilizar Traits com autoload/spl_autload_register e a função trait_exists():</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="k">class</span> <span class="nc">ReaderFile</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">use</span> <span class="nx">LoaderFile</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">function</span> <span class="nf">__autoload</span><span class="p">(</span> <span class="nv">$name</span> <span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nv">$trait</span> <span class="o">=</span> <span class="nv">$name</span><span class="o">.</span><span class="s2">&quot;.php&quot;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span> <span class="nb">file_exists</span><span class="p">(</span> <span class="nv">$trait</span> <span class="p">)</span> <span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>      <span class="k">include_once</span><span class="p">(</span> <span class="nv">$trait</span> <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="nb">trait_exists</span><span class="p">(</span> <span class="nv">$name</span> <span class="p">)</span> <span class="p">)</span>
</span><span class='line'>          <span class="k">throw</span> <span class="k">new</span> <span class="nx">exception</span><span class="p">(</span> <span class="s2">&quot;No trait exists&quot;</span> <span class="p">);</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nx">exception</span><span class="p">(</span><span class="s2">&quot;No file exists&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Conclusão final</p>

<p>Há uma infinidade de maneiras de se usar Traits, como compor Traits dentro de Traits, criando uma hierarquia
de comportamentos. Sem dúvida, Traits trouxe para o PHP muito mais flexibilidade em todos os sentidos.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Diogo Pinto</span></span>

      








  


<time datetime="2012-12-01T22:21:08-02:00" pubdate data-updated="true"></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/php/'>php</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://di0.github.io/blog/2012/12/01/php-reusing-code-with-traits/" data-via="diogolion" data-counturl="http://di0.github.io/blog/2012/12/01/php-reusing-code-with-traits/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/05/25/ignore-temporarily-files-with-git/" title="Previous Post: Ignore temporarily files with git">&laquo; Ignore temporarily files with git</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/05/13/searching-for-table-name/" title="Next Post: Searching for table name">Searching for table name &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  <section>
  <h1>About Me</h1>
  <p>I'm Dio PP, a System Analyst, Software Developer and Unix black screen fan</p>
  
<img src="/images/DarthVaderDarkForce.jpg" alt="Profile picture" />


  <b><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The force is strong with this one</p><br></b>
  <p>You can read more about me on my <a href="/about/">about</a> page. To see what I'm working on, check out my GitHub page <a href="https://github.com/di0">here</a>.</p>
  <p>Furthermore my resume can be found <a href="https://www.linkedin.com/in/diogo-pereira-pinto-7607a13a/">here</a>.</p>
  <div class="social-icons">
    

    
  <a href="http://www.linkedin.com/in/diogo-pereira-pinto-dio"><i class="fa fa-linkedin fa-3x"></i></a>


    
  <a href="https://plus.google.com/115661938273408826648"<i class="fa fa-google-plus fa-3x"></i></a>


    
  <a href="https://github.com/di0"><i class="fa fa-github fa-3x"></i></a>


    
  <a href="https://twitter.com/diogolion"><i class="fa fa-twitter fa-3x"></i></a>


  </div>
</section>

  <section>
  <h1>Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/01/19/creating-webservice-soap-with-java/">Creating WebService SOAP With Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/01/17/determining-symbolic-links-java-with-update-alternatives-command/">Determining Symbolic Links Java With Update-alternatives Command</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/01/07/searching-for-distinct-fields/">MySQL - Searching for Distinct Fields</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/06/multithreading-future-in-java/">MultiThreading - Future in Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/06/maven/">Using Jetty Plugin With Maven and ActiveMQ</a>
      </li>
    
  </ul>
</section>

  
    
<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/115661938273408826648?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/01/19/creating-webservice-soap-with-java/">Creating WebService SOAP With Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/01/17/determining-symbolic-links-java-with-update-alternatives-command/">Determining Symbolic Links Java With Update-alternatives Command</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/01/07/searching-for-distinct-fields/">MySQL - Searching for Distinct Fields</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/06/multithreading-future-in-java/">MultiThreading - Future in Java</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/06/maven/">Using Jetty Plugin With Maven and ActiveMQ</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/freebsd/'>freebsd (1)</a></li><li><a href='/blog/categories/git/'>git (6)</a></li><li><a href='/blog/categories/java/'>java (2)</a></li><li><a href='/blog/categories/linux/'>linux (6)</a></li><li><a href='/blog/categories/maven/'>maven (1)</a></li><li><a href='/blog/categories/mysql/'>mysql (2)</a></li><li><a href='/blog/categories/perl/'>perl (1)</a></li><li><a href='/blog/categories/php/'>php (2)</a></li><li><a href='/blog/categories/svn/'>svn (2)</a></li></ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/di0">@di0</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'di0',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Diogo Pinto -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

<p>
<span>Copyright &copy; 2018  Diogo Pinto -</span>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> using the <a href="https://github.com/fapper/classic-martinb">classic-martinb</a> theme</span>
</p>
</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
